<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.4"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>SOFUS: Article</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../doxygen_html_style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">SOFUS<span id="projectnumber">&#160;..</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.4 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../index.html">SOFUS (SIMD Optimized Fast Ultrasound Simulator)</a></li>  </ul>
</div>
</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">Article </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="section_article"></a>
Article</h1>
<ul>
<li>
<a class="el" href="../../d9/d40/article.html#subsection_abstract">Abstract</a> </li>
<li>
<a class="el" href="../../d9/d40/article.html#subsection_intro">Introduction</a> </li>
<li>
<a class="el" href="../../d9/d40/article.html#subsection_background">Background</a> </li>
<li>
<a class="el" href="../../d9/d40/article.html#subsection_contribution">Contribution</a> </li>
</ul>
<h2><a class="anchor" id="subsection_abstract"></a>
Abstract</h2>
<p >A fast procedure for calculation of spatial impulse responses for linear sound fields is presented. The procedure applies to transducers, which can be represented by a set of convex polygons and it is tailored to exploit data level parallelism as well as concurrency. The procedure is implemented on a modern single instruction, multiple data (SIMD) architecture and used for computing time-harmonic and transient pressure fields. It can be used for both near and far field simulations, since it uses the well known technique of calculating the spatial impulse response from the intersection of a circle emanating from a projected spherical wave with the boundary of the emitting elements. Finally, the performance and accuracy is compared to current state-of-the-art simulation methods including a fast implementation using the far field approach.</p>
<h2><a class="anchor" id="subsection_intro"></a>
Introduction</h2>
<p >Computer simulations are used intensively for developing and evaluating the performance of ultrasound models, beamformers, and signal processing methods applied to ultrasonic data. In therapeutic ultrasound, e.g. high-intensity focused ultrasound (HIFU) or lithotripsy, time-harmonic pressures are used for computation of the energy deposition and subsequent heat transfer calculation. For high-bandwidth imaging systems, more challenging computations of transient pressure fields are needed for computing peak negative pressures, which serves as limits for ensuring patient safety. Finally, computer simulations has been used for developing new applications of ultrasound, within structural imaging, flow imaging and more recently strain imaging.</p>
<h2><a class="anchor" id="subsection_background"></a>
Background</h2>
<p >The acoustic field is most easily studied using the Lagrange picture. In the Lagrange picture, an action is formed by expressing the difference of the kinetic and potential energy of the media, which is given as volume integral of a Lagrange density. The kinetic term is quite easy to find, whereas the potential energy can be found from thermodynamics. If the content, which do not contribute to the equations of motion are removed, the free action can be written as <a class="el" href="../../d0/de3/citelist.html#CITEREF_goldstein1980classical">[6]</a></p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[
S = \int dt\int d^{3}x \frac{1}{2\kappa (\vec{r})}\partial_{t}^{2}p(\vec{r},t) - \frac{1}{2\rho (r)} \nabla p(\vec{r},t)\cdot \nabla p(\vec{r},t),
\]" src="../../form_0.png" width="310" height="58"/>
</p>
<p >where <img class="formulaInl" alt="$\kappa (\vec{r})$" src="../../form_1.png" width="24" height="13"/> is bulk modules and <img class="formulaInl" alt="$\rho(\vec{r})$" src="../../form_2.png" width="24" height="13"/> is the density. Using the principle of least action, <img class="formulaInl" alt="$\delta S=0$" src="../../form_3.png" width="38" height="9"/>, the acoustic wave equation can easily be derived</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[
\nabla \cdot \left(\frac{1}{\rho (\vec{r})}\nabla p(\vec{r},t) \right) - 1/\kappa (\vec{r}) \partial_{t}^{2}p(\vec{r},t)= 0.
\]" src="../../form_4.png" width="231" height="60"/>
</p>
<p >Using Gauss's divergence theorem, the ultrasonic transducer can be added as source term and the pressure at a given point <img class="formulaInl" alt="$\vec{r}_{0}$" src="../../form_5.png" width="13" height="9"/> can be expressed as </p><p class="formulaDsp">
<img class="formulaDsp" alt="\begin{eqnarray}\label{eq:1}
&amp;p(\vec{r}_{0},t) = \nonumber \\
&amp;-\frac{1}{4\pi }\int_{S}dS\, \rho^{-
1}(\vec{r})\left[p(\vec{r},t)\frac{\partial
\mathcal{G}(\vec{r},t;\vec{r}_{0})}{\partial n} - \mathcal{G}(\vec{r},t;\vec{r}_{0})\frac{\partial
p(\vec{r},t)}{\partial n}\right],
\end{eqnarray}" src="../../form_6.png" width="364" height="44"/>
</p>
<p >where <img class="formulaInl" alt="$\partial /\partial n = \vec{n}\cdot \nabla $" src="../../form_7.png" width="69" height="13"/> is the derivative in the direction of the surface normal and <img class="formulaInl" alt="$\mathcal{G}$" src="../../form_8.png" width="8" height="10"/> is the Green's function associated with the problem. Two different solutions exists corresponding to an acoustic hard and an acoustic soft boundary. As noted by Tupholme <a class="el" href="../../d0/de3/citelist.html#CITEREF_tupholme1969generation">[18]</a> , the solution can be expressed using a spatial impulse response <img class="formulaInl" alt="$h(\vec{r},t)$" src="../../form_9.png" width="34" height="13"/>. For an acoustic hard boundary the solution is given by</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\begin{equation}\label{eq:2}
p(\vec{r}_{0},t) = \rho_{0}\dot{v}(t) \ast h(\vec{r}_{0},t),
\end{equation}" src="../../form_10.png" width="286" height="13"/>
</p>
<p >where the asterisk <img class="formulaInl" alt="$\ast$" src="../../form_11.png" width="5" height="5"/> denote a time-like convolution and <img class="formulaInl" alt="$\dot{v}$" src="../../form_12.png" width="8" height="9"/> is the derivative of the particle velocity near the surface. The spatial impulse response can be derived from <img class="formulaInl" alt="$(\ref{eq:1})$" src="../../form_13.png" width="16" height="13"/> by imposing a Neumann boundary condition corresponding to an acoustic hard boundary. It is given by <a class="el" href="../../d0/de3/citelist.html#CITEREF_stepanishen_1971">[17]</a> .</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[
h(\vec{r}_{0},t) = \int_{S}dS\frac{\delta (t - | \vec{r} - \vec{r}_{0}|/c)}{2\pi |\vec{r}-\vec{r}_{0}|}.
\]" src="../../form_14.png" width="181" height="59"/>
</p>
<p >From this equation, it follows that computing the acoustic pressure is a purely geometrical. For a fixed time, <img class="formulaInl" alt="$t$" src="../../form_15.png" width="5" height="8"/>, the spatial impulse response is given by length of intersection of a sphere centered at <img class="formulaInl" alt="$\vec{r}_{0}$" src="../../form_5.png" width="13" height="9"/> intersecting the transducer surface. This interesting feature has led to the derivation of many closed-form spatial impulse response functions for common transducer geometries such as circular pistons <a class="el" href="../../d0/de3/citelist.html#CITEREF_oberhettinger1961transient">[15]</a> , rectangular pistons <a class="el" href="../../d0/de3/citelist.html#CITEREF_lockwood1973high">[13]</a> , triangular pistons <a class="el" href="../../d0/de3/citelist.html#CITEREF_jensen_jasa_1996">[10]</a> , curved <a class="el" href="../../d0/de3/citelist.html#CITEREF_penttinen1976impulse">[16]</a> and spherical geometries <a class="el" href="../../d0/de3/citelist.html#CITEREF_krenk1983geometrical">[12]</a> . The solution for an acoustic soft boundary, where the pressure on the surface is zero, the spatial impulse response is given by</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[
h(\vec{r}_{0},t) = \int_{S}dS\cos{\varphi }\frac{\delta (t - |\vec{r}-\vec{r}_{0}|/c)}{2\pi |\vec{r}-\vec{r}_{0}|},
\]" src="../../form_16.png" width="210" height="59"/>
</p>
<p >where <img class="formulaInl" alt="$\varphi $" src="../../form_17.png" width="8" height="9"/> is the angle between a line passing through the field point <img class="formulaInl" alt="$\vec{r}_{0}$" src="../../form_5.png" width="13" height="9"/> and normal to the transducer, and a line passing through <img class="formulaInl" alt="$\vec{r}_{0}$" src="../../form_5.png" width="13" height="9"/> and the intersection of the spherical wave and the transducer surface. For a fixed time <img class="formulaInl" alt="$t$" src="../../form_15.png" width="5" height="8"/>, the cosine factor, <img class="formulaInl" alt="$\cos{\varphi }$" src="../../form_18.png" width="24" height="9"/> is given by <img class="formulaInl" alt="$\cos{\varphi } = z/(ct)$" src="../../form_19.png" width="75" height="13"/>, where <img class="formulaInl" alt="$z$" src="../../form_20.png" width="6" height="6"/> is the distance from the field point <img class="formulaInl" alt="$\vec{r}_{0}$" src="../../form_5.png" width="13" height="9"/> to the transducer surface. The easy generalization to include a soft boundary applies to all geometries mentioned above.</p>
<p >When Computing transient pressure fields using eq. <img class="formulaInl" alt="$(\ref{eq:4})$" src="../../form_21.png" width="23" height="13"/>, the time derivative of the particle velocity is evaluated from the excitation pulse <img class="formulaInl" alt="$v(t)$" src="../../form_22.png" width="21" height="13"/> and the convolution is evaluated using the fast Fourier transform (FFT). Computation result reveal that the spatial impulse response contains both low and high frequency content, whereas the excitation <img class="formulaInl" alt="$v(t)$" src="../../form_22.png" width="21" height="13"/> is band-limited. To exploit this, it was suggested by D'Hooge to differentiate instead the spatial impulse and compute the pressure according to <a class="el" href="../../d0/de3/citelist.html#CITEREF_d1997calculation">[5]</a></p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[
p(\vec{r}_{0},t) = \rho_{0}v(t) \ast \dot{h}(\vec{r}_{0},t),
\]" src="../../form_23.png" width="143" height="13"/>
</p>
<p >where <img class="formulaInl" alt="$\dot{h}$" src="../../form_24.png" width="8" height="9"/> is the time-derivative of the spatial impulse response. In this way, a much lower sampling frequency can be used for simulating the transients.</p>
<p >Another much earlier attempt for reducing the complexity for computing transients is the simplified trapezoidal impulse-response model used by the simulation tool Field II <a class="el" href="../../d0/de3/citelist.html#CITEREF_jensen1991model">[8]</a> . It is based on analytical expressions for the impulse response derived by Tupholme <a class="el" href="../../d0/de3/citelist.html#CITEREF_tupholme1969generation">[18]</a> and Stepanishen <a class="el" href="../../d0/de3/citelist.html#CITEREF_stepanishen_1971">[17]</a> . Instead of computing the arc length of the spheres intersecting the elements, the elements are divided into multiple rectangular sub-elements and a far field approximation is made, which means that intersection are computed between sub-elements and planar waves rather than a sphere. For completeness, the formulas are given here for the far field approximation used by e.g. Field II. Given a rectangular sub-element spanned by vectors <img class="formulaInl" alt="$\vec{u}$" src="../../form_25.png" width="8" height="9"/> and <img class="formulaInl" alt="$\vec{v}$" src="../../form_26.png" width="8" height="9"/> and a field point <img class="formulaInl" alt="$\vec{r}$" src="../../form_27.png" width="8" height="9"/>, compute the following two lengths</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[
r_{1} = \min\left(\frac{|\vec{r}\cdot\vec{u}|}{r}, \frac{|\vec{r}\cdot \vec{v}|}{r} \right)\quad r_{2} = \max\left(\frac{|\vec{r}\cdot \vec{u}|}{r}, \frac{|\vec{r}\cdot \vec{v}|}{r} \right),
\]" src="../../form_28.png" width="300" height="56"/>
</p>
<p >where <img class="formulaInl" alt="$r$" src="../../form_29.png" width="5" height="6"/> is the length of <img class="formulaInl" alt="$\vec{r}$" src="../../form_27.png" width="8" height="9"/>. The up to four different arrival times for the plane wave can then be calculated by</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\begin{eqnarray}
t_{1} &amp;= \frac{1}{c}\left(r - \frac{r_{1}+r_{2}}{2} \right) \nonumber \\
t_{2} &amp;= t_{1} + \frac{r_{1}}{c} \nonumber \\
t_{3} &amp;= t_{1} + \frac{r_{2}}{c} \nonumber \\ 
t_{4} &amp;= t_{1} + \frac{r_{1}+r_{2}}{c} \nonumber
\end{eqnarray}" src="../../form_30.png" width="108" height="88"/>
</p>
<p >The amplitude of the trapezoidal response is a function of piston area and distance to the field point and is given by</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\begin{equation}\label{eq:7}
h(t) = \left\{\begin{array}{@{}l l r@{\ t\ }l}
\frac{(t-t_{1})^{2}}{2 \Delta t_{2}} &amp; \mathrm{for } &amp;
t_{1}\leq &amp; \leq t_{2}\\
\frac{\Delta t_{1} + 2(t-t_{2})}{2\Delta t_{2}} &amp; \mathrm{for } &amp;
t_{2}\leq &amp; \leq t_{3}\\
1-\frac{(t-t_{3})^{2}}{2\Delta t_{1}\Delta t_{2}}&amp; \mathrm{for } &amp;
t_{3}\leq &amp; \leq t_{4}\\
\end{array}\right\},
\end{equation}" src="../../form_31.png" width="334" height="70"/>
</p>
<p >where <img class="formulaInl" alt="$\Delta t_{1}$" src="../../form_32.png" width="23" height="9"/> and <img class="formulaInl" alt="$\Delta t_{2}$" src="../../form_33.png" width="24" height="9"/> are given by</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[
\Delta t_{1} = t_{2}-t_{1}\qquad \Delta t_{2} = t_{3}-t_{1}.
\]" src="../../form_34.png" width="179" height="9"/>
</p>
<p >The shape of the response depends on <img class="formulaInl" alt="$\Delta t_{1}$" src="../../form_32.png" width="23" height="9"/> and <img class="formulaInl" alt="$\Delta t_{2}$" src="../../form_33.png" width="24" height="9"/>, but the area of the trapezoid integrated over the whole time interval is always equal to <img class="formulaInl" alt="$\frac{4ab}{2\pi r}$" src="../../form_35.png" width="21" height="16"/>, where <img class="formulaInl" alt="$a$" src="../../form_36.png" width="6" height="6"/> and <img class="formulaInl" alt="$b$" src="../../form_37.png" width="5" height="9"/> is the width and the height of the sub-element. It can be shown, that this approximate response is valid for situations, where <img class="formulaInl" alt="$r \gg \frac{ab}{4\lambda }$" src="../../form_38.png" width="43" height="16"/>. For many simulation applications, this approximation is perfectly valid and satisfactory results can be obtained without using many sub-elements. An application which require many sub-elements is the computation of the peak-negative pressure, since in an attenuating media the location of this peak lies in the very near-field.</p>
<p >Another more recent approach for reducing the complexity for computing in particularly time-harmonic pressures is a frequency domain approach introduced by McGough <a class="el" href="../../d0/de3/citelist.html#CITEREF_mcgough2004rapid">[14]</a> . For a rectangular element, the Fast Nearfield Method (FNM) uses the closed-form expression for the spatial impulse response for a field point above the corner of the rectangle <a class="el" href="../../d0/de3/citelist.html#CITEREF_lockwood1973high">[13]</a> ,</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[
h(z,t)=\left\{\begin{array}{@{}l l r@{\ t\ }l}
c/(2\pi) \left\{\frac{\pi }{2} \right\} &amp; \mathrm{for } &amp;
\frac{z}{c}\leq &amp; \leq \frac{\sqrt{z^{2}+a^{2}}}{c}\\
c/(2\pi) \left\{\frac{\pi }{2} -
\arccos{\left(\frac{a}{\sqrt{c^{2}t^{2}-z^{2}}} \right)}\right\} &amp; \mathrm{for } &amp;
\frac{\sqrt{z^{2}+a^{2}}}{c} \leq &amp; \leq \frac{\sqrt{z^{2}+b^{2}}}{c}\\
c/(2\pi) \left\{\frac{\pi }{2} -
\arccos{\left(\frac{a}{\sqrt{c^{2}t^{2}-z^{2}}} \right)} -
\arccos{\left(\frac{b}{\sqrt{c^{2}t^{2}-z^{2}}} \right)}\right\} &amp; \mathrm{for } &amp;
\frac{\sqrt{z^{2}+b^{2}}}{c} \leq &amp; \leq \frac{\sqrt{z^{2}+a^{2}+b^{2}}}{c}\\
\end{array} \right.,
\]" src="../../form_39.png" width="538" height="75"/>
</p>
<p >where the side lengths of the rectangle, <img class="formulaInl" alt="$a$" src="../../form_36.png" width="6" height="6"/> and <img class="formulaInl" alt="$b$" src="../../form_37.png" width="5" height="9"/> are selected such that <img class="formulaInl" alt="$b\geq a$" src="../../form_40.png" width="26" height="10"/>.</p>
<p >Using some algebra, the Fourier transform of this equation can be written as <a class="el" href="../../d0/de3/citelist.html#CITEREF_mcgough2004rapid">[14]</a> .</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\begin{equation}\label{eq:6}
H(z,k)=-\frac{\mathrm{i}}{2\pi
k}\left(a\int_{0}^{b}d\sigma\frac{\exp{(-\mathrm{i}k\sqrt{z^{2}+\sigma^{2}+a^{2}})}-\exp{(-\mathrm{i}kz)}}{\sigma^{2}+a^{2}}
+ b\int_{0}^{a}d\sigma\frac{\exp{(-\mathrm{i}k\sqrt{z^{2}+\sigma^{2}+b^{2}})}-\exp{(-\mathrm{i}kz)}}{\sigma^{2}+b^{2}}
\right)
\end{equation}" src="../../form_41.png" width="608" height="88"/>
</p>
<p >Equation <img class="formulaInl" alt="$(\ref{eq:6})$" src="../../form_42.png" width="16" height="13"/> can be used to very accurately compute the time-harmonic pressure not just above the corner but at any point using the principle of superposition. This method is used as a reference in this work. FNM has been developed further for other geometries <a class="el" href="../../d0/de3/citelist.html#CITEREF_chen_fnm_tri_2006">[4]</a> as well as to include the computation of transient fields using time-space decomposition for a range of excitation functions <a class="el" href="../../d0/de3/citelist.html#CITEREF_kelly_tsd_2006">[11]</a> and for a general frequency domain signal <a class="el" href="../../d0/de3/citelist.html#CITEREF_alles2012rapid">[1]</a> . This method is very fast, but for wide-band pulses, where many frequencies are needed, it is beneficial to use a time-domain method instead.</p>
<h2><a class="anchor" id="subsection_contribution"></a>
Contribution</h2>
<p >The simulation tool Field II can be used for simulating transients using the simplified far field approximation (default), a closed form solution for triangles <a class="el" href="../../d0/de3/citelist.html#CITEREF_jensen_jasa_1996">[10]</a> or a closed form solution for an arbitrary polygon by specifying the transducer boundaries using lines <a class="el" href="../../d0/de3/citelist.html#CITEREF_jensen1999new">[9]</a> . What motivated this work was that using the accurate methods was 2 orders of magnitude slower than using the far field approximation. Since modern computers are extremely fast and support both instruction level parallelism as well as concurrency, the bottleneck for algorithms is often memory access rather than computational power. This suggests that it should be possible to formulate an algorithm, which eliminates the need for using the far field approximation. (DIES HERE)</p>
<p >Instead of computing the impulse response by first computing arrival times, possibly followed by sorting and expensive line-sphere intersections, the method described here is generic and is tailored for a modern single instruction, multiple data (SIMD) architecture. The algorithm is best explained by the simple drawing of arc segments computed for a triangle and an rectangle in Fig.</p>
<p >The procedure is as follows. Project the field point <img class="formulaInl" alt="$\vec{r}_{0} $" src="../../form_43.png" width="13" height="9"/> into a plane containing the element. For each vertex-edge pair, compute 3 contributions corresponding to: 1. The projection lies in a position, where the projected circle for a time <img class="formulaInl" alt="$t$" src="../../form_15.png" width="5" height="8"/> intersects the edge in two positions, 2. The projection lies in a position, where the projected circle intersects the edge such that the continuation of the circle after the intersection continues clock-wise. 3. The projection lies in a position, where the circle intersects the edge such that the continuation of the circle is counter clock-wise. For each contribution, two angles are computed, <img class="formulaInl" alt="$\theta_{0}$" src="../../form_44.png" width="13" height="9"/> and <img class="formulaInl" alt="$\theta_{1} $" src="../../form_45.png" width="11" height="9"/> such that the arc segment is the difference between the two angles, <img class="formulaInl" alt="$\Delta \theta =\theta_{1}-\theta_{0}$" src="../../form_46.png" width="74" height="9"/>. If the arc is passing its vertex in a counter clock-wise direction, the angle <img class="formulaInl" alt="$\theta_{0}$" src="../../form_44.png" width="13" height="9"/> is set equal to the angle corresponding to the normal of the previous edge. An example of this is the limits of outer red segments in Fig. The outer red segments start from an angles, which correspond to the normal of the cyan contribution. If the arc is passing its next vertex in a clock-wise direction, the angle <img class="formulaInl" alt="$\theta_{1}$" src="../../form_47.png" width="11" height="9"/> is set equal to the angle of a normal of the current edge. A simple mask constructed using the distances from the field point <img class="formulaInl" alt="$\vec{r}_{0}$" src="../../form_5.png" width="13" height="9"/>to the vertices and signed distances from the projection to lines is used for selecting one of the 3 contributions. This mask is needed once for each field point, but there is no need to compute this for each sample. Segments are computed described for all vertex-edge pairs and finally, the angular contribution to the impulse response is <img class="formulaInl" alt="$2\pi $" src="../../form_48.png" width="13" height="9"/> minus the sum of all vertex-edge segments. The neat things is that all segments can be computed independently. It is in fact possible to simulate a full ultrasound pressure field for a rectangular element, by simulating 4 fields, a field for each of the vertices. This observation is particularly useful for massive parallel computation, e.g. computation using GPUs.</p>
<h2><a class="anchor" id="subsection_results"></a>
Results</h2>
<p >Three methods were implemented. An SIMD implementation of the far field approach <img class="formulaInl" alt="$(\ref{eq:7})$" src="../../form_49.png" width="16" height="13"/>, the proposed method illustrated in Fig. as well as the fast near method, which was used for reference. Goertzel's algorithm was used for extracting the time-harmonic pressure from the time-like pressure transients computed using the far field approach or the proposed method. In Fig., the normalized pressure using the proposed algorithm is computed for 64-element focused array.</p>
<h2><a class="anchor" id="subsection_conclusion"></a>
Conclusion</h2>
<p >From the results in Table , it follows that in order to achieve accurate results, the proposed method is fast enough to eliminate the need for using the far field approximation.</p>
<p >It will be interesting to investigate this further for other applications, e.g. imaging. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue May 17 2022 09:21:06 for SOFUS by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.4
</small></address>
</body>
</html>
